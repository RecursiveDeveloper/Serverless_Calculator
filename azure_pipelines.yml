pool: 
  name: Default

resources:
  webhooks:
    - webhook: WebHook
      connection: CDWebHook_Connection

steps: 
  - task: NodeTool@0
    inputs:
      versionSource: 'spec'
      versionSpec: '6.x'

  - task: Npm@1
    inputs:
      command: 'install'
      workingDir: '$(System.DefaultWorkingDirectory)/app'

  - task: ArchiveFiles@2
    inputs:
      rootFolderOrFile: '$(System.DefaultWorkingDirectory)/app'
      includeRootFolder: false
      archiveType: 'zip'
      archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
      replaceExistingArchive: true

  - task: LambdaDeployFunction@1
    inputs:
      awsCredentials: 'AWS_Connection'
      regionName: 'us-east-1'
      deploymentMode: 'codeonly'
      functionName: 'hello_world'
      codeLocation: 'localfile'
      localZipFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
      